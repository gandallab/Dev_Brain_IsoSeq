{
  "hash": "ea14d201aabecbea02f2aafc7c9414f0",
  "result": {
    "markdown": "---\ntitle: \"Figure 5 - Table S5D\"\nauthor: \"Ashok Patowary\"\nexecute:\n  cache: false\n  freeze: auto\neditor: source\neditor_options:\n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nisoT4k_filter = readRDS(\"data/working/isoT4k_filter.rds\")\nlevels(isoT4k_filter$orig.ident) = gsub(\"\\\\.\", \"-\", levels(isoT4k_filter$orig.ident)) # ExM.U becomes ExM-U\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: SeuratObject\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nAttaching sp\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Seurat\n```\n:::\n\n```{.r .cell-code}\nisoT4k_filter\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAn object of class Seurat \n141112 features across 4167 samples within 2 assays \nActive assay: RNA (87162 features, 0 variable features)\n 1 other assay present: SCT\n 2 dimensional reductions calculated: pca, umap\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n################Identifying gene with different isoforms significantly expressed in different cell types\n#####Code is adapted from https://doi.org/10.1038/s41467-020-17800-6\n\n\nclusters <- c(\"End\", \"ExDp1\", \"ExDp2\", \"ExM\", \"ExM.U\", \"ExN\", \"InCGE\", \"InMGE\", \"IP\", \"Mic\", \"OPC\", \"oRG\", \"Per\", \"PgG2M\", \"PgS\", \"vRG\")\nIdents(isoT4k_filter) <- isoT4k_filter$CellType\n\ntotal <- data.frame()\ntotaladj <- data.frame()\nfor (i in (1:15)){\n  k <- i+1\n  for (j in (k:16)){\n    if(i != j){\n      print(paste(i, \" \", j, \" \",clusters[i], \" vs \", clusters[j], sep=\"\"))\n      \n      markers <- FindMarkers(object = isoT4k_filter , ident.1=clusters[i], ident.2=clusters[j])\n      markers$cluster <- clusters[j]\n      markers$contrast <- paste(clusters[i], \"vs\", clusters[j], sep=\" \")\n      markers[which(markers$avg_log2FC>0),]$cluster <- clusters[i]\n      markers$geneId <- sapply(strsplit(rownames(markers), \"-ENS|-TAL\"), `[`, 1)\n      markers$transcriptId <- sapply(strsplit(rownames(markers), \"-ENS|-TAL\"), `[`, 2)\n      markers <- markers[markers$p_val < 0.05,]\n      all.genes <- unique(markers$geneId)\n      for (k in (1:length(all.genes))){\n        sub <- markers[which(markers$geneId == all.genes[k]),]\n        nb.clusters <- unique(sub$cluster)\n        nb.transcripts <- unique(sub$transcriptId)\n        \n        if(length(nb.clusters) > 1 & length(nb.transcripts) > 1){\n          total <- rbind(total, sub)\n        }\n      }\n      \n      markers <- markers[markers$p_val_adj < 0.05,]\n      all.genes <- unique(markers$geneId)\n      for (k in (1:length(all.genes))){\n        sub <- markers[which(markers$geneId == all.genes[k]),]\n        nb.clusters <- unique(sub$cluster)\n        nb.transcripts <- unique(sub$transcriptId)\n        \n        if(length(nb.clusters) > 1 & length(nb.transcripts) > 1){\n          totaladj <- rbind(totaladj, sub)\n        }\n      }\n      print (dim(total))\n      print (length(unique(total$geneId)))\n    }\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"1 2 End vs ExDp1\"\n[1] 10  9\n[1] 4\n[1] \"1 3 End vs ExDp2\"\n[1] 10  9\n[1] 4\n[1] \"1 4 End vs ExM\"\n[1] 25  9\n[1] 7\n[1] \"1 5 End vs ExM.U\"\n[1] 44  9\n[1] 10\n[1] \"1 6 End vs ExN\"\n[1] 56  9\n[1] 10\n[1] \"1 7 End vs InCGE\"\n[1] 66  9\n[1] 10\n[1] \"1 8 End vs InMGE\"\n[1] 75  9\n[1] 10\n[1] \"1 9 End vs IP\"\n[1] 92  9\n[1] 10\n[1] \"1 10 End vs Mic\"\n[1] 92  9\n[1] 10\n[1] \"1 11 End vs OPC\"\n[1] 94  9\n[1] 10\n[1] \"1 12 End vs oRG\"\n[1] 110   9\n[1] 11\n[1] \"1 13 End vs Per\"\n[1] 110   9\n[1] 11\n[1] \"1 14 End vs PgG2M\"\n[1] 135   9\n[1] 13\n[1] \"1 15 End vs PgS\"\n[1] 155   9\n[1] 14\n[1] \"1 16 End vs vRG\"\n[1] 172   9\n[1] 15\n[1] \"2 3 ExDp1 vs ExDp2\"\n[1] 172   9\n[1] 15\n[1] \"2 4 ExDp1 vs ExM\"\n[1] 178   9\n[1] 18\n[1] \"2 5 ExDp1 vs ExM.U\"\n[1] 180   9\n[1] 19\n[1] \"2 6 ExDp1 vs ExN\"\n[1] 184   9\n[1] 20\n[1] \"2 7 ExDp1 vs InCGE\"\n[1] 188   9\n[1] 22\n[1] \"2 8 ExDp1 vs InMGE\"\n[1] 192   9\n[1] 24\n[1] \"2 9 ExDp1 vs IP\"\n[1] 200   9\n[1] 24\n[1] \"2 10 ExDp1 vs Mic\"\n[1] 221   9\n[1] 29\n[1] \"2 11 ExDp1 vs OPC\"\n[1] 221   9\n[1] 29\n[1] \"2 12 ExDp1 vs oRG\"\n[1] 246   9\n[1] 38\n[1] \"2 13 ExDp1 vs Per\"\n[1] 256   9\n[1] 40\n[1] \"2 14 ExDp1 vs PgG2M\"\n[1] 273   9\n[1] 41\n[1] \"2 15 ExDp1 vs PgS\"\n[1] 283   9\n[1] 41\n[1] \"2 16 ExDp1 vs vRG\"\n[1] 302   9\n[1] 41\n[1] \"3 4 ExDp2 vs ExM\"\n[1] 306   9\n[1] 43\n[1] \"3 5 ExDp2 vs ExM.U\"\n[1] 314   9\n[1] 45\n[1] \"3 6 ExDp2 vs ExN\"\n[1] 318   9\n[1] 45\n[1] \"3 7 ExDp2 vs InCGE\"\n[1] 320   9\n[1] 46\n[1] \"3 8 ExDp2 vs InMGE\"\n[1] 322   9\n[1] 47\n[1] \"3 9 ExDp2 vs IP\"\n[1] 330   9\n[1] 48\n[1] \"3 10 ExDp2 vs Mic\"\n[1] 332   9\n[1] 48\n[1] \"3 11 ExDp2 vs OPC\"\n[1] 334   9\n[1] 48\n[1] \"3 12 ExDp2 vs oRG\"\n[1] 346   9\n[1] 48\n[1] \"3 13 ExDp2 vs Per\"\n[1] 346   9\n[1] 48\n[1] \"3 14 ExDp2 vs PgG2M\"\n[1] 350   9\n[1] 49\n[1] \"3 15 ExDp2 vs PgS\"\n[1] 363   9\n[1] 50\n[1] \"3 16 ExDp2 vs vRG\"\n[1] 374   9\n[1] 50\n[1] \"4 5 ExM vs ExM.U\"\n[1] 376   9\n[1] 50\n[1] \"4 6 ExM vs ExN\"\n[1] 378   9\n[1] 51\n[1] \"4 7 ExM vs InCGE\"\n[1] 378   9\n[1] 51\n[1] \"4 8 ExM vs InMGE\"\n[1] 383   9\n[1] 52\n[1] \"4 9 ExM vs IP\"\n[1] 387   9\n[1] 53\n[1] \"4 10 ExM vs Mic\"\n[1] 405   9\n[1] 54\n[1] \"4 11 ExM vs OPC\"\n[1] 411   9\n[1] 56\n[1] \"4 12 ExM vs oRG\"\n[1] 434   9\n[1] 59\n[1] \"4 13 ExM vs Per\"\n[1] 447   9\n[1] 60\n[1] \"4 14 ExM vs PgG2M\"\n[1] 455   9\n[1] 60\n[1] \"4 15 ExM vs PgS\"\n[1] 460   9\n[1] 60\n[1] \"4 16 ExM vs vRG\"\n[1] 478   9\n[1] 61\n[1] \"5 6 ExM.U vs ExN\"\n[1] 495   9\n[1] 65\n[1] \"5 7 ExM.U vs InCGE\"\n[1] 506   9\n[1] 66\n[1] \"5 8 ExM.U vs InMGE\"\n[1] 519   9\n[1] 69\n[1] \"5 9 ExM.U vs IP\"\n[1] 537   9\n[1] 70\n[1] \"5 10 ExM.U vs Mic\"\n[1] 567   9\n[1] 72\n[1] \"5 11 ExM.U vs OPC\"\n[1] 569   9\n[1] 72\n[1] \"5 12 ExM.U vs oRG\"\n[1] 590   9\n[1] 72\n[1] \"5 13 ExM.U vs Per\"\n[1] 608   9\n[1] 74\n[1] \"5 14 ExM.U vs PgG2M\"\n[1] 626   9\n[1] 74\n[1] \"5 15 ExM.U vs PgS\"\n[1] 641   9\n[1] 74\n[1] \"5 16 ExM.U vs vRG\"\n[1] 661   9\n[1] 75\n[1] \"6 7 ExN vs InCGE\"\n[1] 665   9\n[1] 76\n[1] \"6 8 ExN vs InMGE\"\n[1] 665   9\n[1] 76\n[1] \"6 9 ExN vs IP\"\n[1] 667   9\n[1] 76\n[1] \"6 10 ExN vs Mic\"\n[1] 676   9\n[1] 76\n[1] \"6 11 ExN vs OPC\"\n[1] 676   9\n[1] 76\n[1] \"6 12 ExN vs oRG\"\n[1] 690   9\n[1] 77\n[1] \"6 13 ExN vs Per\"\n[1] 699   9\n[1] 78\n[1] \"6 14 ExN vs PgG2M\"\n[1] 718   9\n[1] 83\n[1] \"6 15 ExN vs PgS\"\n[1] 743   9\n[1] 88\n[1] \"6 16 ExN vs vRG\"\n[1] 767   9\n[1] 92\n[1] \"7 8 InCGE vs InMGE\"\n[1] 767   9\n[1] 92\n[1] \"7 9 InCGE vs IP\"\n[1] 769   9\n[1] 92\n[1] \"7 10 InCGE vs Mic\"\n[1] 773   9\n[1] 92\n[1] \"7 11 InCGE vs OPC\"\n[1] 775   9\n[1] 92\n[1] \"7 12 InCGE vs oRG\"\n[1] 795   9\n[1] 97\n[1] \"7 13 InCGE vs Per\"\n[1] 808   9\n[1] 100\n[1] \"7 14 InCGE vs PgG2M\"\n[1] 842   9\n[1] 103\n[1] \"7 15 InCGE vs PgS\"\n[1] 879   9\n[1] 104\n[1] \"7 16 InCGE vs vRG\"\n[1] 901   9\n[1] 106\n[1] \"8 9 InMGE vs IP\"\n[1] 903   9\n[1] 106\n[1] \"8 10 InMGE vs Mic\"\n[1] 907   9\n[1] 106\n[1] \"8 11 InMGE vs OPC\"\n[1] 911   9\n[1] 107\n[1] \"8 12 InMGE vs oRG\"\n[1] 947   9\n[1] 111\n[1] \"8 13 InMGE vs Per\"\n[1] 961   9\n[1] 114\n[1] \"8 14 InMGE vs PgG2M\"\n[1] 987   9\n[1] 115\n[1] \"8 15 InMGE vs PgS\"\n[1] 1022    9\n[1] 120\n[1] \"8 16 InMGE vs vRG\"\n[1] 1043    9\n[1] 121\n[1] \"9 10 IP vs Mic\"\n[1] 1060    9\n[1] 122\n[1] \"9 11 IP vs OPC\"\n[1] 1064    9\n[1] 122\n[1] \"9 12 IP vs oRG\"\n[1] 1070    9\n[1] 123\n[1] \"9 13 IP vs Per\"\n[1] 1081    9\n[1] 123\n[1] \"9 14 IP vs PgG2M\"\n[1] 1085    9\n[1] 124\n[1] \"9 15 IP vs PgS\"\n[1] 1094    9\n[1] 126\n[1] \"9 16 IP vs vRG\"\n[1] 1098    9\n[1] 126\n[1] \"10 11 Mic vs OPC\"\n[1] 1101    9\n[1] 126\n[1] \"10 12 Mic vs oRG\"\n[1] 1125    9\n[1] 127\n[1] \"10 13 Mic vs Per\"\n[1] 1125    9\n[1] 127\n[1] \"10 14 Mic vs PgG2M\"\n[1] 1157    9\n[1] 130\n[1] \"10 15 Mic vs PgS\"\n[1] 1198    9\n[1] 136\n[1] \"10 16 Mic vs vRG\"\n[1] 1239    9\n[1] 139\n[1] \"11 12 OPC vs oRG\"\n[1] 1243    9\n[1] 141\n[1] \"11 13 OPC vs Per\"\n[1] 1243    9\n[1] 141\n[1] \"11 14 OPC vs PgG2M\"\n[1] 1245    9\n[1] 141\n[1] \"11 15 OPC vs PgS\"\n[1] 1252    9\n[1] 141\n[1] \"11 16 OPC vs vRG\"\n[1] 1258    9\n[1] 141\n[1] \"12 13 oRG vs Per\"\n[1] 1266    9\n[1] 142\n[1] \"12 14 oRG vs PgG2M\"\n[1] 1268    9\n[1] 142\n[1] \"12 15 oRG vs PgS\"\n[1] 1270    9\n[1] 142\n[1] \"12 16 oRG vs vRG\"\n[1] 1270    9\n[1] 142\n[1] \"13 14 Per vs PgG2M\"\n[1] 1288    9\n[1] 145\n[1] \"13 15 Per vs PgS\"\n[1] 1305    9\n[1] 146\n[1] \"13 16 Per vs vRG\"\n[1] 1313    9\n[1] 146\n[1] \"14 15 PgG2M vs PgS\"\n[1] 1315    9\n[1] 146\n[1] \"14 16 PgG2M vs vRG\"\n[1] 1318    9\n[1] 146\n[1] \"15 16 PgS vs vRG\"\n[1] 1320    9\n[1] 147\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Top hits p_val_adj < 0.05\n\nlength(unique(totaladj$geneId))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7\n```\n:::\n\n```{.r .cell-code}\nprint(unique(totaladj$geneId))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"CADM1\" \"GPM6A\" \"MAP1B\" \"APP\"   \"RTN4\"  \"DCTN2\" \"PFN2\" \n```\n:::\n\n```{.r .cell-code}\nwrite.table(totaladj, file=\"output/tables/TableS5D.txt\", sep=\"\\t\", quote = F)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lower hits p_val < 0.05\n\n#length(unique(total$geneId))\n#print(unique(total$geneId))\n#write.table(total, file=\"isoswitch.v2.txt\", sep=\"\\t\", quote = F)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}